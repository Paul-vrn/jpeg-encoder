#include <stdlib.h>
#include <stdio.h>
#include <stdint.h>
#include <stdbool.h>
#include <math.h>
#include <assert.h>
#include "vector.h"
#include "huffman.h"
#include "htables.h"
#include "frequential_bloc.h"


/*void test_get_bits_needed(){
    int16_t test[11] = {0, 1, -1, 2, -3, 4, -5, 25, 63, 64, 2047};
    uint32_t res[11] = {0, 1, 1, 2, 2, 3, 3, 5, 6, 7, 11};
    for (uint32_t i = 0; i < 11; i++)
    {
        assert(get_bits_needed(test[i]) == res[i]);
    }
}

void test_quantification(){
    int16_t tab[64] = 
    {
        0x0183, 0x0086, 0xff2e, 0x004f, 0xffa9, 0xffa7, 0xfffd, 0x0041,
        0xfff8, 0x000e, 0xfff3, 0x003b, 0xffca, 0xfffd, 0xffff, 0xfffe,
        0x0002, 0x001c, 0x000f, 0xffdd, 0xfff0, 0x001f, 0x0000, 0x0013,
        0xffdd, 0xfffe, 0x0002, 0x0000, 0x0002, 0xffff, 0xfffe, 0x0000,
        0x001f, 0xffe0, 0x0000, 0xffff, 0x0000, 0xfffc, 0x0001, 0xffd9,
        0xffff, 0x0000, 0xfffd, 0x0001, 0x0000, 0x0002, 0x002d, 0xffff,
        0x0001, 0x0000, 0x0003, 0xfffc, 0xfffe, 0x0000, 0xfffd, 0x0001,
        0x0003, 0xfffd, 0xfffd, 0xfffe, 0x0003, 0xfffc, 0x0000, 0x0002
    };
    int16_t tab_res[64] = 
    {
        0x004d, 0x002d, 0xffba, 0x0010, 0xfff4, 0xfffe, 0x0000, 0x0004,
        0xfffe, 0x0004, 0xfffd, 0x000a, 0xfff9, 0x0000, 0x0000, 0x0000,
        0x0001, 0x0007, 0x0003, 0xfffb, 0xffff, 0x0002, 0x0000, 0x0001,
        0xfff7, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
        0x0006, 0xfffb, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0xfffe,
        0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0001, 0x0000,
        0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000,
        0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000, 0x0000
    };
    struct vector_t *vect = create_vector(tab);
    quantificationY(vect);
    for (uint8_t i = 0; i < 64; i++)
    {
        //assert(vector_get(i) == tab_res[i]); marche pas car les deux sont diffÃ©rents de 1 ou -1
    }

}
<<<<<<< Updated upstream

=======
*/
void test_zigzag(){
    int16_t tab[8][8] = 
    {{0x007b, 0x0000, 0xfee4, 0x0000, 0x0000, 0x0000, 0xffec, 0x0000}, 
	{0xfffb, 0x0000, 0xfedb, 0x0000, 0x006a, 0x0000, 0xff7e, 0x0000}, 
	{0xfeb3, 0x0000, 0xff8c, 0x0000, 0x0045, 0x0000, 0x0099, 0x0000}, 
	{0xff37, 0x0000, 0xffa1, 0x0000, 0x0018, 0x0000, 0x0003, 0x0000}, 
	{0x007f, 0x0000, 0x011c, 0x0000, 0x00ff, 0x0000, 0x0014, 0x0000}, 
	{0xffa7, 0x0000, 0x0013, 0x0000, 0x007d, 0x0000, 0xfe1f, 0x0000}, 
	{0xff76, 0x0000, 0x001a, 0x0000, 0xff5a, 0x0000, 0x00f4, 0x0000}, 
	{0x00dc, 0x0000, 0xffa9, 0x0000, 0xffba, 0x0000, 0xff3d, 0x0000}};

<<<<<<< HEAD
    struct frequential_bloc_t *fbloc = frequential_bloc_create(tab);
    struct vector_t *tab_res = create_vector_from_bloc(fbloc);
    
    /*
    int16_t result[64] = {
	0x007b,0x0000,0xfffb,0xfeb3,0x0000,0xfee4,0x0000,0xfedb,
	0x0000,0xff37,0x007f,0x0000,0xff8c,0x0000,0x0000,0x0000,
	0x006a,0x0000,0xffa1,0x0000,0xffa7,0xff76,0x0000,0x011c,
	0x0000,0x0045,0x0000,0xffec,0x0000,0xff7e,0x0000,0x0018,
	0x0000,0x0013,0x0000,0x00dc,0x0000,0x001a,0x0000,0x00ff,
	0x0000,0x0099,0x0000,0x0000,0x0003,0x0000,0x007d,0x0000,
	0xffa9,0x0000,0xff5a,0x0000,0x0014,0x0000,0x0000,0xfe1f,
	0x0000,0xffba,0x0000,0x00f4,0x0000,0x0000,0xff3d,0x0000
  }
    */
    vector_print(tab_res);
}
>>>>>>> Stashed changes
=======
void test_zigzag(){
    int16_t tab[8][8] = 
    {{1,2,3,4,5,6,7,8},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8,},
    {1,2,3,4,5,6,7,8}};

    struct frequential_bloc_t *fbloc = create_frequential_bloc(tab);
    struct vector_t *tab_res = create_vector_from_bloc(fbloc);

    frequential_bloc_print(tab_res);
}
>>>>>>> master
int main(void)
{
    printf("test vector!\n");
    //test_quantification();
    //test_get_bits_needed();
    test_zigzag();
    return EXIT_SUCCESS;
}
